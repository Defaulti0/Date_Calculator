<!doctype html>
<html>
  <head>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script src="taskpane.js"></script>
    <link rel="stylesheet" href="taskpane.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />
  </head>

  <body id="wholePage">
    <h2 id="title">Change Appointment Date</h2>
    <input type="text" id="dateInput" placeholder="Enter date" />

    <ul id="sampleList">
      <li>Examples:</li>
      <li>Today, Tomorrow, Yesterday, Last Friday, etc</li>
      <li>5 days ago</li>
      <li>2 weeks from now</li>
      <li>Sat Aug 17 2025</li>
      <li>2025-11-30</li>
    </ul>

    <label for="startTimePicker">Start Time:</label>
    <input type="time" id="startTimePicker" class="timePicker">

    <br></br>

    <label for="endTimePicker">End Time:</label>
    <input type="time" id="endTimePicker" class="timePicker">

    <br></br>

    <div class="calendar" id="calendar">
      <div class="calendar-header">
        <h2 id="monthYear"></h2>
      </div>
      <div class="calendar-grid" id="calendarGrid"></div>
    </div>

    <script>
      function populateTimePicker(elementId) {
        const timePicker = document.getElementById(elementId);
        timePicker.innerHTML = "";

        const startTime = new Date();
        startTime.setHours(0, 0, 0, 0);

        const endTime = new Date();
        endTime.setHours(23, 59, 0, 0);

        const interval = 30 * 60 * 1000;

        let currentTime = new Date(startTime);

        while (currentTime <= endTime) {
          const hours = currentTime.getHours().toString().padStart(2, "0");
          const minutes = currentTime.getMinutes().toString().padStart(2, "0");
          const timeString = `${hours}:${minutes}`;

          const option = document.createElement("option");
          option.value = timeString;
          option.textContent = timeString;
          timePicker.appendChild(option);

          currentTime.setTime(currentTime.getTime() + interval);
        }
      }

      populateTimePicker('startTimePicker');
      populateTimePicker('endTimePicker');
    </script>

  <br></br>

    <button id="updateButton">Update Date</button>
  </body>
</html>
